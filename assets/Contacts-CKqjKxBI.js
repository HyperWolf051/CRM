import{j as e,S as t,B as a,a as s,b as r}from"./index-Bzv9HkLu.js";import{r as n}from"./react-vendor-DD48japz.js";import{A as l}from"./Avatar-vcWBLne4.js";import{B as i}from"./Badge-BalMkqCb.js";import{E as c}from"./EmptyState-D3FrKalv.js";import{U as o,R as d,C as m,r as x,p as h}from"./icons-vendor-Cvv-27T5.js";import{I as p}from"./Input-_nxkVJ-m.js";import{M as u}from"./Modal-BCZnj9tP.js";import{u as g}from"./useContacts-F-0poF1v.js";import{a as y}from"./validation-Bmklxit8.js";import{a as j}from"./router-vendor-CA0F1SnT.js";import"./http-vendor-ei4kQ0Q2.js";const f=n.memo(({contacts:s=[],loading:r=!1,onContactClick:n,onEditContact:d,onDeleteContact:m,className:x="",...h})=>{const p=e=>{switch(e){case"active":return"success";case"inactive":default:return"neutral";case"lead":return"info"}},u=e=>{switch(e){case"active":return"Active";case"inactive":return"Inactive";case"lead":return"Lead";default:return"Unknown"}};return r?e.jsx("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden ${x}`,...h,children:e.jsx("div",{className:"overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:e.jsxs("table",{className:"min-w-full lg:min-w-[800px] xl:min-w-[1000px] divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.from({length:5}).map((a,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(t,{width:40,height:40,className:"rounded-full mr-4"}),e.jsxs("div",{children:[e.jsx(t,{width:120,height:16,className:"mb-1"}),e.jsx(t,{width:80,height:12})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(t,{width:150,height:16})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(t,{width:120,height:16})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(t,{width:100,height:16})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(t,{width:60,height:20,className:"rounded-full"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx(t,{width:24,height:24,className:"rounded ml-auto"})})]},s))})]})})}):s&&0!==s.length?e.jsx("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden ${x}`,...h,children:e.jsx("div",{className:"overflow-x-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100",children:e.jsxs("table",{className:"min-w-full lg:min-w-[800px] xl:min-w-[1000px] divide-y divide-gray-200",role:"table","aria-label":"Contacts list",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",scope:"col",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",scope:"col",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",scope:"col",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",scope:"col",children:"Company"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",scope:"col",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",scope:"col",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(t=>e.jsxs("tr",{onClick:()=>null==n?void 0:n(t),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),null==n||n(t))},tabIndex:0,role:"button","aria-label":`View details for ${t.name}`,className:"hover:bg-gray-50 cursor-pointer transition-all duration-150 hover:shadow-sm transform hover:scale-[1.01] focus:outline-none focus:bg-gray-50 focus:ring-2 focus:ring-primary-500 focus:ring-inset",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(l,{src:t.avatar,name:t.name,size:"md",className:"mr-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",t.id]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.phone||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.company||"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(i,{variant:p(t.status),children:u(t.status)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs("label",{className:"sr-only",htmlFor:`actions-select-${t.id}`,children:["Actions for ",t.name]}),e.jsxs("select",{id:`actions-select-${t.id}`,className:"border border-gray-200 rounded px-2 py-1 text-sm text-gray-700 bg-white hover:shadow-sm focus:outline-none focus:ring-2 focus:ring-primary-500",onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),onChange:e=>{e.stopPropagation();const a=e.target.value;"edit"===a?(null==d||d(t),e.target.selectedIndex=0):"delete"===a?(null==m||m(t),e.target.selectedIndex=0):e.target.selectedIndex=0},"aria-label":`Actions for ${t.name}`,defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Actions"}),e.jsx("option",{value:"edit",children:"Edit"}),e.jsx("option",{value:"delete",children:"Delete"})]})]})]},t.id))})]})})}):e.jsx("div",{className:`bg-white rounded-lg shadow-sm border border-gray-200 ${x}`,...h,children:e.jsx(c,{icon:e.jsx(o,{size:48}),title:"No contacts found",description:"Get started by adding your first contact to the CRM.",action:e.jsx(a,{variant:"primary",onClick:()=>null==d?void 0:d(),children:"Add Contact"})})})}),v=({onRetry:t,children:s="Retry",variant:r="secondary",size:l="sm",className:i="",...c})=>{const[o,m]=n.useState(!1);return e.jsx(a,{variant:r,size:l,onClick:async()=>{if(!o&&t){m(!0);try{await t()}catch(e){}finally{m(!1)}}},loading:o,disabled:o,icon:e.jsx(d,{className:"w-4 h-4"}),className:i,...c,children:s})},w=({contact:t,onSubmit:s,onCancel:r,loading:l})=>{const[i,c]=n.useState({name:(null==t?void 0:t.name)||"",email:(null==t?void 0:t.email)||"",phone:(null==t?void 0:t.phone)||"",company:(null==t?void 0:t.company)||"",address:(null==t?void 0:t.address)||"",notes:(null==t?void 0:t.notes)||"",status:(null==t?void 0:t.status)||"lead"}),[o,d]=n.useState({}),m=e=>t=>{c(a=>({...a,[e]:t.target.value})),o[e]&&d(t=>({...t,[e]:""}))};return e.jsxs("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return i.name.trim()||(e.name="Name is required"),i.email.trim()?y(i.email)||(e.email="Please enter a valid email address"):e.email="Email is required",d(e),0===Object.keys(e).length})()&&s(i)},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(p,{label:"Name *",value:i.name,onChange:m("name"),error:o.name,placeholder:"Enter full name"}),e.jsx(p,{label:"Email *",type:"email",value:i.email,onChange:m("email"),error:o.email,placeholder:"Enter email address"}),e.jsx(p,{label:"Phone",type:"tel",value:i.phone,onChange:m("phone"),error:o.phone,placeholder:"Enter phone number"}),e.jsx(p,{label:"Company",value:i.company,onChange:m("company"),error:o.company,placeholder:"Enter company name"})]}),e.jsx(p,{label:"Address",value:i.address,onChange:m("address"),error:o.address,placeholder:"Enter address"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Status"}),e.jsxs("select",{value:i.status,onChange:m("status"),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",children:[e.jsx("option",{value:"lead",children:"Lead"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Notes"}),e.jsx("textarea",{value:i.notes,onChange:m("notes"),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Add any notes about this contact..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(a,{type:"button",variant:"secondary",onClick:r,disabled:l,children:"Cancel"}),e.jsx(a,{type:"submit",loading:l,children:t?"Update Contact":"Create Contact"})]})]})},N=()=>{const t=j(),{showToast:l}=s(),{contacts:i,loading:c,error:o,createContact:d,updateContact:y,deleteContact:N,refetch:b}=g(),[C,k]=n.useState(""),[S,A]=n.useState(!1),[E,D]=n.useState(null),[I,$]=n.useState(!1),[P,z]=n.useState(null),[L,R]=n.useState(!1),M=n.useRef(null),O=n.useMemo(()=>{if(!C.trim())return i;const e=C.toLowerCase();return i.filter(t=>{var a,s;return t.name.toLowerCase().includes(e)||t.email.toLowerCase().includes(e)||(null==(a=t.company)?void 0:a.toLowerCase().includes(e))||(null==(s=t.phone)?void 0:s.includes(e))})},[i,C]),B=()=>{D(null),A(!0)},F=()=>{A(!1),D(null)},T=()=>{$(!1),z(null)};return r("/",()=>{M.current&&M.current.focus()}),r("c",()=>{B()}),o?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(m,{className:"text-red-500 mb-4",size:48}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Failed to load contacts"}),e.jsx("p",{className:"text-gray-500 mb-4",children:o}),e.jsx(v,{onRetry:b,children:"Try Again"})]}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contacts"}),e.jsx("p",{className:"text-gray-500",children:"Manage your customer relationships and contact information"})]}),e.jsx(a,{onClick:B,icon:e.jsx(x,{size:20}),children:"Add Contact"})]}),e.jsx("div",{className:"max-w-sm lg:max-w-md",children:e.jsx(p,{ref:M,placeholder:"Search contacts...",value:C,onChange:e=>{k(e.target.value)},icon:e.jsx(h,{size:20})})}),e.jsx(f,{contacts:O,loading:c,onContactClick:e=>{t(`/app/contacts/${e.id}`)},onEditContact:e=>{D(e),A(!0)},onDeleteContact:e=>{z(e),$(!0)}}),e.jsx(u,{isOpen:S,onClose:F,title:E?"Edit Contact":"Create New Contact",className:"max-w-2xl",children:e.jsx(w,{contact:E,onSubmit:async e=>{R(!0);try{let t;t=E?await y(E.id,e):await d(e),t.success?(l("success",`Contact ${E?"updated":"created"} successfully`),A(!1),D(null)):l("error",t.error)}catch(t){l("error","An unexpected error occurred")}finally{R(!1)}},onCancel:F,loading:L})}),e.jsx(u,{isOpen:I,onClose:T,title:"Delete Contact",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to delete ",e.jsx("strong",{children:null==P?void 0:P.name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(a,{variant:"secondary",onClick:T,children:"Cancel"}),e.jsx(a,{variant:"danger",onClick:async()=>{if(P)try{const e=await N(P.id);e.success?(l("success","Contact deleted successfully"),$(!1),z(null)):l("error",e.error)}catch(e){l("error","Failed to delete contact")}},children:"Delete Contact"})]})]})})]})};export{N as default};
