const e=new class{constructor(){this.metrics=new Map,this.observers=new Map,this.isEnabled="true"===localStorage.getItem("performance-monitoring")}initCoreWebVitals(){this.isEnabled&&(this.observePaint(),this.observeLCP(),this.observeCLS(),this.observeFID())}observePaint(){if(!("PerformanceObserver"in window))return;const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{"first-contentful-paint"===e.name&&this.recordMetric("FCP",e.startTime)})});e.observe({entryTypes:["paint"]}),this.observers.set("paint",e)}observeLCP(){if(!("PerformanceObserver"in window))return;const e=new PerformanceObserver(e=>{const t=e.getEntries(),i=t[t.length-1];this.recordMetric("LCP",i.startTime)});e.observe({entryTypes:["largest-contentful-paint"]}),this.observers.set("lcp",e)}observeCLS(){if(!("PerformanceObserver"in window))return;let e=0;const t=new PerformanceObserver(t=>{t.getEntries().forEach(t=>{t.hadRecentInput||(e+=t.value)}),this.recordMetric("CLS",e)});t.observe({entryTypes:["layout-shift"]}),this.observers.set("cls",t)}observeFID(){if(!("PerformanceObserver"in window))return;const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{this.recordMetric("FID",e.processingStart-e.startTime)})});e.observe({entryTypes:["first-input"]}),this.observers.set("fid",e)}measureComponentRender(e,t){if(!this.isEnabled)return t();const i=performance.now(),n=t(),r=performance.now()-i;return this.recordMetric(`${e}_render`,r),n}monitorMemoryUsage(){if(!this.isEnabled||!performance.memory)return;const e=performance.memory,t={used:Math.round(e.usedJSHeapSize/1024/1024),total:Math.round(e.totalJSHeapSize/1024/1024),limit:Math.round(e.jsHeapSizeLimit/1024/1024)};return this.recordMetric("memory",t),t}monitorNetworkRequests(){if(!this.isEnabled)return;const e=new PerformanceObserver(e=>{e.getEntries().forEach(e=>{if("navigation"===e.entryType&&this.recordMetric("page_load",e.loadEventEnd-e.fetchStart),"resource"===e.entryType){e.responseEnd,e.startTime}})});e.observe({entryTypes:["navigation","resource"]}),this.observers.set("network",e)}async monitorBundleSize(){if(this.isEnabled)try{if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate(),t=Math.round(e.usage/1024);this.recordMetric("bundle_size",t)}}catch(e){}}monitorAnimationPerformance(e,t){if(!this.isEnabled)return;let i=0,n=performance.now();const r=()=>{i++;const t=performance.now()-n;if(t>=1e3){const n=Math.round(1e3*i/t);return void this.recordMetric(`${e}_fps`,n)}requestAnimationFrame(r)};requestAnimationFrame(r)}monitorUserInteractions(){if(!this.isEnabled)return;["click","keydown","scroll","touchstart"].forEach(e=>{document.addEventListener(e,e=>{performance.now();requestAnimationFrame(()=>{performance.now()})},{passive:!0})})}recordMetric(e,t){this.metrics.has(e)||this.metrics.set(e,[]),this.metrics.get(e).push({value:t,timestamp:Date.now()});const i=this.metrics.get(e);i.length>100&&i.shift()}getPerformanceReport(){const e={};return this.metrics.forEach((t,i)=>{const n=t.map(e=>e.value);e[i]={current:n[n.length-1],average:n.reduce((e,t)=>e+t,0)/n.length,min:Math.min(...n),max:Math.max(...n),count:n.length}}),e}getRecommendations(){const e=this.getPerformanceReport(),t=[];return e.FCP&&e.FCP.average>1800&&t.push({type:"FCP",message:"First Contentful Paint is slow. Consider optimizing critical rendering path.",priority:"high"}),e.LCP&&e.LCP.average>2500&&t.push({type:"LCP",message:"Largest Contentful Paint is slow. Optimize largest element loading.",priority:"high"}),e.CLS&&e.CLS.average>.1&&t.push({type:"CLS",message:"Cumulative Layout Shift is high. Reserve space for dynamic content.",priority:"medium"}),e.memory&&e.memory.average>50&&t.push({type:"Memory",message:"High memory usage detected. Check for memory leaks.",priority:"medium"}),t}cleanup(){this.observers.forEach(e=>{e.disconnect()}),this.observers.clear(),this.metrics.clear()}enable(){this.isEnabled=!0,localStorage.setItem("performance-monitoring","true")}disable(){this.isEnabled=!1,localStorage.removeItem("performance-monitoring"),this.cleanup()}};"undefined"!=typeof window&&(e.initCoreWebVitals(),e.monitorNetworkRequests(),e.monitorUserInteractions(),e.monitorBundleSize(),setInterval(()=>{e.monitorMemoryUsage()},3e4),window.performanceMonitor=e);const t=new class{constructor(){this.isProduction=!0,this.optimizations=[]}async initialize(){try{await this.applyImageOptimizations(),await this.applyFontOptimizations(),await this.applyCSSOptimizations(),await this.applyJavaScriptOptimizations(),await this.applyNetworkOptimizations(),await this.applyAccessibilityOptimizations(),await this.applyPerformanceMonitoring(),this.generateOptimizationReport()}catch(e){}}async applyImageOptimizations(){document.querySelectorAll("img").forEach(e=>{e.loading||(e.loading="lazy",e.decoding="async")}),this.addWebPSupport(),this.optimizeImageSizes(),this.optimizations.push("Image lazy loading and WebP support")}async applyFontOptimizations(){const e=document.createElement("style");e.textContent="\n      @font-face {\n        font-display: swap;\n      }\n    ",document.head.appendChild(e),this.preloadCriticalFonts(),this.optimizations.push("Font display optimization and preloading")}async applyCSSOptimizations(){this.inlineCriticalCSS(),this.optimizeAnimations(),this.addGPUAcceleration(),this.optimizations.push("CSS critical path and animation optimization")}async applyJavaScriptOptimizations(){"serviceWorker"in navigator&&this.isProduction&&await this.registerServiceWorker(),this.setupIntersectionObserver(),this.optimizeEventListeners(),this.optimizations.push("Service worker and event optimization")}async applyNetworkOptimizations(){this.addResourceHints(),this.setupRequestCaching(),this.addCompressionHeaders(),this.optimizations.push("Network caching and compression")}async applyAccessibilityOptimizations(){this.setupFocusManagement(),this.addMissingAriaLabels(),this.optimizeForScreenReaders(),this.optimizations.push("Accessibility enhancements")}async applyPerformanceMonitoring(){e.enable(),this.setupErrorTracking(),this.setupPerformanceBudgets(),this.optimizations.push("Performance monitoring and error tracking")}addWebPSupport(){const e=document.createElement("canvas");e.width=1,e.height=1;0===e.toDataURL("image/webp").indexOf("data:image/webp")?document.documentElement.classList.add("webp-support"):document.documentElement.classList.add("no-webp-support")}optimizeImageSizes(){document.querySelectorAll("img[data-sizes]").forEach(e=>{const t=e.dataset.sizes;t&&(e.sizes=t)})}preloadCriticalFonts(){["/fonts/inter-regular.woff2","/fonts/inter-medium.woff2","/fonts/inter-semibold.woff2"].forEach(e=>{const t=document.createElement("link");t.rel="preload",t.as="font",t.type="font/woff2",t.crossOrigin="anonymous",t.href=e,document.head.appendChild(t)})}inlineCriticalCSS(){const e=document.createElement("style");e.textContent="\n      .above-fold { contain: layout; }\n      .critical-path { will-change: auto; }\n    ",document.head.insertBefore(e,document.head.firstChild)}optimizeAnimations(){document.querySelectorAll('[class*="animate-"], [class*="transition-"]').forEach(e=>{e.style.transform=e.style.transform||"translateZ(0)",e.addEventListener("animationstart",()=>{e.style.willChange="transform, opacity"}),e.addEventListener("animationend",()=>{e.style.willChange="auto"})})}addGPUAcceleration(){document.querySelectorAll('[class*="transform"], [class*="scale-"], [class*="rotate-"]').forEach(e=>{e.style.transform.includes("translateZ")||(e.style.transform+=" translateZ(0)")})}async registerServiceWorker(){try{await navigator.serviceWorker.register("/sw.js")}catch(e){}}setupIntersectionObserver(){if(!("IntersectionObserver"in window))return;const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const i=t.target;"IMG"===i.tagName&&i.dataset.src&&(i.src=i.dataset.src,i.removeAttribute("data-src"),e.unobserve(i)),i.classList.contains("lazy-component")&&(i.classList.add("loaded"),e.unobserve(i))}})},{rootMargin:"50px 0px",threshold:.1});document.querySelectorAll("img[data-src], .lazy-component").forEach(t=>{e.observe(t)})}optimizeEventListeners(){let e;["scroll","touchstart","touchmove","wheel"].forEach(e=>{document.addEventListener(e,()=>{},{passive:!0})}),window.addEventListener("resize",()=>{clearTimeout(e),e=setTimeout(()=>{window.dispatchEvent(new Event("optimizedResize"))},250)})}addResourceHints(){[{rel:"dns-prefetch",href:"//fonts.googleapis.com"},{rel:"dns-prefetch",href:"//api.example.com"},{rel:"preconnect",href:"//fonts.gstatic.com",crossorigin:!0}].forEach(e=>{const t=document.createElement("link");Object.assign(t,e),document.head.appendChild(t)})}setupRequestCaching(){const e=new Map,t=window.fetch;window.fetch=async(i,n={})=>{if(n.method&&"GET"!==n.method)return t(i,n);const r=`${i}${JSON.stringify(n)}`;if(e.has(r)){const t=e.get(r);if(Date.now()-t.timestamp<3e5)return Promise.resolve(t.response.clone())}const o=await t(i,n);return o.ok&&e.set(r,{response:o.clone(),timestamp:Date.now()}),o}}addCompressionHeaders(){}setupFocusManagement(){document.addEventListener("keydown",e=>{"Tab"===e.key&&document.body.classList.add("keyboard-navigation")}),document.addEventListener("mousedown",()=>{document.body.classList.remove("keyboard-navigation")}),this.addSkipLinks()}addMissingAriaLabels(){document.querySelectorAll("button:not([aria-label]):not([aria-labelledby])").forEach(e=>{e.textContent.trim()||e.setAttribute("aria-label","Button")});document.querySelectorAll("input:not([aria-label]):not([aria-labelledby])").forEach(e=>{!e.labels||e.labels.length})}optimizeForScreenReaders(){const e=document.createElement("div");e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.className="sr-only",e.id="live-region",document.body.appendChild(e),this.addLandmarkRoles()}addSkipLinks(){const e=document.createElement("a");e.href="#main-content",e.textContent="Skip to main content",e.className="skip-link",e.style.cssText="\n      position: absolute;\n      top: -40px;\n      left: 6px;\n      background: #000;\n      color: #fff;\n      padding: 8px;\n      text-decoration: none;\n      z-index: 1000;\n    ",e.addEventListener("focus",()=>{e.style.top="6px"}),e.addEventListener("blur",()=>{e.style.top="-40px"}),document.body.insertBefore(e,document.body.firstChild)}addLandmarkRoles(){if(!document.querySelector('main, [role="main"]')){const e=document.querySelector("#main-content, .main-content, .content");e&&e.setAttribute("role","main")}const e=document.querySelector("nav:not([role])");e&&(e.setAttribute("role","navigation"),e.setAttribute("aria-label","Main navigation"))}setupErrorTracking(){window.addEventListener("error",e=>{}),window.addEventListener("unhandledrejection",e=>{})}setupPerformanceBudgets(){Object.entries({FCP:1800,LCP:2500,CLS:.1,FID:100}).forEach(([t,i])=>{e.recordMetric(`budget_${t}`,i)})}generateOptimizationReport(){this.optimizations.forEach((e,t)=>{})}};"undefined"!=typeof window&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{t.initialize()}):t.initialize());export{t as default};
