import{j as e}from"./index-LnfGub8m.js";import{r as s}from"./react-vendor-DD48japz.js";import{a as t}from"./csvMappings-CudA6gLI.js";import{a as l}from"./router-vendor-CA0F1SnT.js";import{K as a,a as r,F as i,W as n,d as c,z as o}from"./icons-vendor-CEd8OCNO.js";import"./http-vendor-ei4kQ0Q2.js";function d(){const d="registration",x=[],m=l(),[u,h]=s.useState([]),[g,p]=s.useState({start:"",end:""}),[j,b]=s.useState("all"),[v,f]=s.useState(!1),[N,y]=s.useState(!1),w=s.useCallback(()=>{const e=t[d];return e?Object.entries(e).map(([e,s])=>({csvField:e,targetField:s,displayName:S(s),category:C(s)})):[]},[d]),S=e=>({cvNo:"CV Number",name:"Name",phone:"Phone",email:"Email",location:"Location",interestedFor:"Interested For",designation:"Designation",totalExperience:"Experience",lastSalary:"Last Salary",salaryExpectation:"Expected Salary",qualification:"Qualification",allocation:"Allocation","registration.date":"Registration Date","registration.resource":"Source","registration.registrationStatus":"Registration Status","registration.registrationAmount":"Registration Amount","resumeSharing.shortlistsForClient":"Client (Resume)","resumeSharing.resumeShareStatus":"Resume Status","resumeSharing.remark":"Resume Remark","shortlisting.shortlistDate":"Shortlist Date","shortlisting.shortlistsForClient":"Client (Shortlist)","shortlisting.resource":"Shortlist Source","shortlisting.shortlistStatus":"Shortlist Status","lineupFeedback.shortlistDate":"Lineup Date","lineupFeedback.shortlistsForClient":"Lineup Client","lineupFeedback.lineupStatus":"Lineup Status","selection.client":"Selection Client","selection.selectionDate":"Selection Date","selection.selectionStatus":"Selection Status","closure.joiningDate":"Joining Date","closure.placedIn":"Placed In","closure.offeredSalary":"Offered Salary","closure.charges":"Charges","closure.joiningStatus":"Joining Status"}[e]||e),C=e=>e.startsWith("registration.")?"Registration":e.startsWith("resumeSharing.")?"Resume Sharing":e.startsWith("shortlisting.")?"Shortlisting":e.startsWith("lineupFeedback.")?"Lineup & Feedback":e.startsWith("selection.")?"Selection":e.startsWith("closure.")?"Closure":"Basic Information";s.useState(()=>{const e=w();h(e.map(e=>e.csvField))},[w]);const F=s.useCallback(()=>{let e=[...x];return(g.start||g.end)&&(e=e.filter(e=>{var s;const t=new Date(e.createdAt||(null==(s=e.registration)?void 0:s.date)),l=g.start?new Date(g.start):null,a=g.end?new Date(g.end):null;return!(l&&t<l)&&!(a&&t>a)})),"all"!==j&&(e=e.filter(e=>e.overallStatus===j)),e},[x,g,j]),k=s.useCallback((e,s)=>{const l=t[d],a=s.map(e=>e),r=e.map(e=>s.map(s=>{const t=l[s];if(!t)return"";const a=t.split(".");let r=e;for(const e of a)r=null==r?void 0:r[e];return null==r?"":"object"==typeof r?JSON.stringify(r):"string"==typeof r&&r.includes(",")?`"${r}"`:String(r)}));return[a.join(","),...r.map(e=>e.join(","))].join("\n")},[d]),D=s.useCallback(async()=>{if(0!==u.length){f(!0);try{const e=F(),s=k(e,u),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),l=window.URL.createObjectURL(t),a=document.createElement("a");a.href=l,a.download=`${d}_export_${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(l),y(!0)}catch(e){alert("Export failed: "+e.message)}finally{f(!1)}}else alert("Please select at least one field to export")},[u,F,k,d,g,j]),R=w().reduce((e,s)=>{const t=s.category;return e[t]||(e[t]=[]),e[t].push(s),e},{}),E=F();return N?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-between h-16",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>m(-1),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(a,{className:"w-5 h-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Export Complete"})})]})})})}),e.jsx("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-50 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(r,{className:"w-8 h-8 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Export Complete"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Your CSV file has been downloaded successfully."}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 mb-8",children:e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-green-800",children:"Records exported:"}),e.jsx("span",{className:"text-green-600",children:E.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-green-800",children:"Fields included:"}),e.jsx("span",{className:"text-green-600",children:u.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-green-800",children:"File format:"}),e.jsx("span",{className:"text-green-600",children:"CSV"})]})]})}),e.jsx("button",{onClick:()=>m(-1),className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Done"})]})})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex items-center justify-between h-16",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>m(-1),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(a,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Export Data"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Export ",d," data to CSV format"]})]})]})})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export Summary"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(i,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Total Records"})]}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:x.length})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-900",children:"Filtered Records"})]}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:E.length})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-purple-900",children:"Selected Fields"})]}),e.jsx("span",{className:"text-lg font-bold text-purple-600",children:u.length})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Export Filters"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date Range"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"date",value:g.start,onChange:e=>p(s=>({...s,start:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("input",{type:"date",value:g.end,onChange:e=>p(s=>({...s,end:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Filter"}),e.jsxs("select",{value:j,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"in-process",children:"In Process"}),e.jsx("option",{value:"shortlisted",children:"Shortlisted"}),e.jsx("option",{value:"interviewed",children:"Interviewed"}),e.jsx("option",{value:"selected",children:"Selected"}),e.jsx("option",{value:"placed",children:"Placed"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]})]})})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Select Fields to Export"}),e.jsx("div",{className:"space-y-6",children:Object.entries(R).map(([s,t])=>{const l=t.every(e=>u.includes(e.csvField)),a=t.some(e=>u.includes(e.csvField));return e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s}),e.jsx("button",{onClick:()=>((e,s)=>{const t=s.filter(s=>s.category===e);if(t.every(e=>u.includes(e.csvField)))h(e=>e.filter(e=>!t.some(s=>s.csvField===e)));else{const e=t.map(e=>e.csvField);h(s=>[...new Set([...s,...e])])}})(s,t),className:"text-sm px-3 py-1 rounded-md font-medium transition-colors "+(l?"bg-blue-600 text-white":a?"bg-blue-100 text-blue-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:l?"Deselect All":"Select All"})]})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(s=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.includes(s.csvField),onChange:()=>{return e=s.csvField,void h(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]);var e},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:s.displayName})]},s.csvField))})})]},s)})})]})})})]})}),e.jsx("div",{className:"bg-white border-t border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between py-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[E.length," records will be exported"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>m(-1),className:"px-4 py-2 text-gray-600 hover:text-gray-900 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:D,disabled:v||0===u.length,className:"flex items-center space-x-2 bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(o,{className:"w-4 h-4"}),e.jsx("span",{children:v?"Exporting...":"Export CSV"})]})]})]})})})]})}export{d as default};
