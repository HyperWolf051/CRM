import{j as e,B as t}from"./index-Bzv9HkLu.js";import{r as s}from"./react-vendor-DD48japz.js";import{M as a}from"./Modal-BCZnj9tP.js";import{ac as r,J as i,ad as l,aF as n,Z as c,g as o,n as d,_ as x,l as m,K as u,aG as h,z as g,S as p,W as y,C as b,aC as j,u as f,T as v,aH as N,r as w,Q as k,d as S,e as C,a as A,t as D,D as T,a6 as R,ap as E,R as M,aw as _,av as W,c as I,A as L,aE as B,U as $}from"./icons-vendor-Cvv-27T5.js";import"./router-vendor-CA0F1SnT.js";import"./http-vendor-ei4kQ0Q2.js";const U={triggers:[{type:"trigger",subType:"candidate-added",label:"Candidate Added",icon:"UserPlus",description:"Triggers when a new candidate is added",defaultData:{type:"candidate-added",conditions:{},description:"When a new candidate is added"}},{type:"trigger",subType:"status-changed",label:"Status Changed",icon:"GitBranch",description:"Triggers when candidate status changes",defaultData:{type:"status-changed",conditions:{fromStatus:"",toStatus:""},description:"When candidate status changes"}},{type:"trigger",subType:"score-threshold",label:"Score Threshold",icon:"Target",description:"Triggers when lead score reaches threshold",defaultData:{type:"score-threshold",conditions:{threshold:80,operator:"greater-than"},description:"When lead score exceeds threshold"}},{type:"trigger",subType:"time-based",label:"Time Based",icon:"Clock",description:"Triggers on schedule",defaultData:{type:"time-based",conditions:{},schedule:{expression:"0 9 * * *"},description:"Scheduled trigger"}}],conditions:[{type:"condition",subType:"field-equals",label:"Field Equals",icon:"Filter",description:"Check if field equals value",defaultData:{type:"field-equals",field:"",operator:"equals",value:"",logicalOperator:"AND"}},{type:"condition",subType:"score-greater-than",label:"Score Greater Than",icon:"Target",description:"Check if score is above threshold",defaultData:{type:"score-greater-than",field:"leadScore",operator:"greater-than",value:70,logicalOperator:"AND"}}],actions:[{type:"action",subType:"send-email",label:"Send Email",icon:"Mail",description:"Send email to candidate or recruiter",defaultData:{type:"send-email",parameters:{template:"",subject:"",recipient:"candidate"},delay:0,description:"Send email"}},{type:"action",subType:"update-status",label:"Update Status",icon:"GitBranch",description:"Update candidate status",defaultData:{type:"update-status",parameters:{status:""},delay:0,description:"Update candidate status"}},{type:"action",subType:"create-task",label:"Create Task",icon:"CheckSquare",description:"Create task for recruiter",defaultData:{type:"create-task",parameters:{title:"",priority:"medium",assignedTo:""},delay:0,description:"Create task"}},{type:"action",subType:"calculate-score",label:"Calculate Score",icon:"Target",description:"Recalculate lead score",defaultData:{type:"calculate-score",parameters:{},delay:0,description:"Calculate lead score"}},{type:"action",subType:"assign-territory",label:"Assign Territory",icon:"UserPlus",description:"Auto-assign to territory",defaultData:{type:"assign-territory",parameters:{},delay:0,description:"Auto-assign to territory"}}]},P={UserPlus:g,GitBranch:h,Target:u,Clock:m,Filter:x,Mail:d,CheckSquare:o,Zap:c},F=({template:t,onDragStart:s})=>{const a=P[t.icon]||c;return e.jsxs("div",{draggable:!0,onDragStart:e=>s(e,t),className:"flex items-center p-3 bg-white border border-gray-200 rounded-lg cursor-move hover:border-blue-300 hover:shadow-sm transition-all",children:[e.jsx(a,{className:"w-5 h-5 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-gray-900",children:t.label}),e.jsx("div",{className:"text-xs text-gray-500",children:t.description})]})]})},O=({node:t,isSelected:s,onSelect:a,onDelete:r,onEdit:i})=>{const l=P[t.data.icon]||c;return e.jsxs("div",{className:`absolute p-4 rounded-lg border-2 cursor-pointer transition-all min-w-[200px] ${(e=>{switch(e){case"trigger":return"bg-green-50 border-green-200 text-green-800";case"condition":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"action":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}})(t.type)} ${s?"ring-2 ring-blue-500":""}`,style:{left:t.position.x,top:t.position.y},onClick:()=>a(t.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(l,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"font-medium text-sm",children:t.type.toUpperCase()})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),i(t)},className:"p-1 hover:bg-white rounded",children:e.jsx(p,{className:"w-3 h-3"})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),r(t.id)},className:"p-1 hover:bg-white rounded text-red-600",children:e.jsx(y,{className:"w-3 h-3"})})]})]}),e.jsx("div",{className:"text-sm font-medium",children:t.data.description||"Untitled"}),t.data.parameters&&e.jsxs("div",{className:"text-xs mt-1 opacity-75",children:[Object.keys(t.data.parameters).length," parameters"]})]})},z=({node:r,isOpen:i,onClose:l,onSave:n})=>{var c,o,d,x,m;const[u,h]=s.useState((null==r?void 0:r.data)||{});return r?e.jsx(a,{isOpen:i,onClose:l,title:`Configure ${r.type}`,className:"max-w-lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:u.description||"",onChange:e=>h(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),"trigger"===r.type&&"score-threshold"===u.type&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Threshold"}),e.jsx("input",{type:"number",value:(null==(c=u.conditions)?void 0:c.threshold)||80,onChange:e=>h(t=>({...t,conditions:{...t.conditions,threshold:parseInt(e.target.value)}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),"condition"===r.type&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Field"}),e.jsx("input",{type:"text",value:u.field||"",onChange:e=>h(t=>({...t,field:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Value"}),e.jsx("input",{type:"text",value:u.value||"",onChange:e=>h(t=>({...t,value:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),"action"===r.type&&"send-email"===u.type&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Template"}),e.jsxs("select",{value:(null==(o=u.parameters)?void 0:o.template)||"",onChange:e=>h(t=>({...t,parameters:{...t.parameters,template:e.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select template"}),e.jsx("option",{value:"welcome-email",children:"Welcome Email"}),e.jsx("option",{value:"interview-reminder",children:"Interview Reminder"}),e.jsx("option",{value:"status-update",children:"Status Update"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("input",{type:"text",value:(null==(d=u.parameters)?void 0:d.subject)||"",onChange:e=>h(t=>({...t,parameters:{...t.parameters,subject:e.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),"action"===r.type&&"create-task"===u.type&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Title"}),e.jsx("input",{type:"text",value:(null==(x=u.parameters)?void 0:x.title)||"",onChange:e=>h(t=>({...t,parameters:{...t.parameters,title:e.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:(null==(m=u.parameters)?void 0:m.priority)||"medium",onChange:e=>h(t=>({...t,parameters:{...t.parameters,priority:e.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),"action"===r.type&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delay (minutes)"}),e.jsx("input",{type:"number",value:u.delay||0,onChange:e=>h(t=>({...t,delay:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(t,{variant:"outline",onClick:l,className:"flex-1",children:"Cancel"}),e.jsx(t,{onClick:()=>{n(r.id,u),l()},className:"flex-1",children:"Save Configuration"})]})]})}):null},H=({workflow:a,onSave:c,onClose:o})=>{const[d,x]=s.useState((null==a?void 0:a.nodes)||[]),[m,u]=s.useState((null==a?void 0:a.connections)||[]),[h,g]=s.useState(null),[p,y]=s.useState(!1),[b,j]=s.useState(null),[f,v]=s.useState((null==a?void 0:a.name)||""),[N,w]=s.useState((null==a?void 0:a.description)||""),[k,S]=s.useState((null==a?void 0:a.isActive)??!0),C=s.useRef(null),A=(e,t)=>{e.dataTransfer.setData("application/json",JSON.stringify(t))},D=s.useCallback(e=>{e.preventDefault();const t=JSON.parse(e.dataTransfer.getData("application/json")),s=C.current.getBoundingClientRect(),a={id:`node_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:t.type,position:{x:e.clientX-s.left-100,y:e.clientY-s.top-50},data:{...t.defaultData,icon:t.icon},connections:[]};x(e=>[...e,a])},[]),T=e=>{g(e)},R=e=>{x(t=>t.filter(t=>t.id!==e)),u(t=>t.filter(t=>t.sourceNodeId!==e&&t.targetNodeId!==e)),h===e&&g(null)},E=e=>{j(e),y(!0)};return d.find(e=>e.id===h),e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Workflow Builder"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Drag components to canvas"})]}),e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Workflow Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),e.jsx("input",{type:"text",value:f,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Enter workflow name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:N,onChange:e=>w(e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Describe this workflow"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:k,onChange:e=>S(e.target.checked),className:"mr-2"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm text-gray-700",children:"Active"})]})]})]}),e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Triggers"}),e.jsx("div",{className:"space-y-2",children:U.triggers.map(t=>e.jsx(F,{template:t,onDragStart:A},t.subType))})]}),e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Conditions"}),e.jsx("div",{className:"space-y-2",children:U.conditions.map(t=>e.jsx(F,{template:t,onDragStart:A},t.subType))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Actions"}),e.jsx("div",{className:"space-y-2",children:U.actions.map(t=>e.jsx(F,{template:t,onDragStart:A},t.subType))})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{onClick:()=>{var e;const t={id:(null==a?void 0:a.id)||`workflow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:f,description:N,isActive:k,nodes:d,connections:m,trigger:(null==(e=d.find(e=>"trigger"===e.type))?void 0:e.data)||{},conditions:d.filter(e=>"condition"===e.type).map(e=>e.data),actions:d.filter(e=>"action"===e.type).map(e=>e.data)};c(t)},icon:e.jsx(r,{className:"w-4 h-4"}),disabled:!f||0===d.length,children:"Save Workflow"}),e.jsx(t,{variant:"outline",icon:e.jsx(i,{className:"w-4 h-4"}),children:"Export"}),e.jsx(t,{variant:"outline",icon:e.jsx(l,{className:"w-4 h-4"}),children:"Import"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[d.length," nodes"]}),e.jsx(t,{variant:"outline",onClick:o,children:"Close"})]})]})}),e.jsx("div",{className:"flex-1 relative overflow-hidden",children:e.jsxs("div",{ref:C,className:"w-full h-full bg-gray-50 relative",onDrop:D,onDragOver:e=>{e.preventDefault()},children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"\n                  linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px),\n                  linear-gradient(90deg, rgba(0,0,0,0.1) 1px, transparent 1px)\n                ",backgroundSize:"20px 20px"}}),0===d.length&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(n,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"Drag components here to build your workflow"}),e.jsx("p",{className:"text-sm",children:"Start with a trigger, add conditions, then actions"})]})}),d.map(t=>e.jsx(O,{node:t,isSelected:h===t.id,onSelect:T,onDelete:R,onEdit:E},t.id)),m.map(t=>{const s=d.find(e=>e.id===t.sourceNodeId),a=d.find(e=>e.id===t.targetNodeId);return s&&a?e.jsxs("svg",{className:"absolute inset-0 pointer-events-none",style:{zIndex:1},children:[e.jsx("line",{x1:s.position.x+100,y1:s.position.y+50,x2:a.position.x+100,y2:a.position.y+50,stroke:"#3B82F6",strokeWidth:"2",markerEnd:"url(#arrowhead)"}),e.jsx("defs",{children:e.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:e.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#3B82F6"})})})]},t.id):null})]})})]}),e.jsx(z,{node:b,isOpen:p,onClose:()=>y(!1),onSave:(e,t)=>{x(s=>s.map(s=>s.id===e?{...s,data:t}:s))}})]})};const q=new class{constructor(){this.workflows=new Map,this.executions=new Map,this.leadScores=new Map,this.territories=new Map,this.scoringRules=new Map,this.emailSequences=new Map,this.webhooks=new Map,this.initializeMockData()}async createWorkflow(e){const t={id:`workflow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...e,createdAt:new Date,lastModified:new Date,executionCount:0,successRate:0};return this.workflows.set(t.id,t),t}async updateWorkflow(e,t){const s=this.workflows.get(e);if(!s)throw new Error("Workflow not found");const a={...s,...t,lastModified:new Date};return this.workflows.set(e,a),a}async deleteWorkflow(e){return this.workflows.delete(e)}async getWorkflow(e){return this.workflows.get(e)}async getAllWorkflows(){return Array.from(this.workflows.values())}async getActiveWorkflows(){return Array.from(this.workflows.values()).filter(e=>e.isActive)}async executeWorkflow(e,t,s={}){const a=this.workflows.get(e);if(!a||!a.isActive)throw new Error("Workflow not found or inactive");const r={id:`exec_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,workflowId:e,candidateId:t,status:"running",startedAt:new Date,executedActions:[],context:s};this.executions.set(r.id,r);try{if(!(await this.evaluateConditions(a.conditions,t,s)))return r.status="completed",r.completedAt=new Date,r;for(const e of a.actions){const a=await this.executeAction(e,t,s);if(r.executedActions.push(a),"failed"===a.status){r.status="failed",r.error=a.error;break}}"running"===r.status&&(r.status="completed"),r.completedAt=new Date,a.executionCount++,a.lastExecuted=new Date,"completed"===r.status?a.successRate=(a.successRate*(a.executionCount-1)+100)/a.executionCount:a.successRate=a.successRate*(a.executionCount-1)/a.executionCount}catch(i){r.status="failed",r.error=i.message,r.completedAt=new Date}return r}async evaluateConditions(e,t,s){if(!e||0===e.length)return!0;for(const a of e){if(!(await this.evaluateCondition(a,t,s))&&"OR"!==a.logicalOperator)return!1}return!0}async evaluateCondition(e,t,s){switch(e.type){case"score-greater-than":const a=this.leadScores.get(t);return a&&a.totalScore>e.value;case"field-equals":return s[e.field]===e.value;default:return!0}}async executeAction(e,t,s){const a={actionId:e.id,actionType:e.type,status:"pending",executedAt:new Date};try{switch(e.type){case"send-email":await this.sendEmail(e.parameters,t);break;case"update-status":await this.updateCandidateStatus(t,e.parameters.status);break;case"assign-recruiter":await this.assignRecruiter(t,e.parameters.recruiterId);break;case"create-task":await this.createTask(e.parameters,t);break;case"calculate-score":await this.calculateLeadScore(t);break;case"assign-territory":await this.assignTerritory(t);break;case"webhook":await this.callWebhook(e.parameters,t,s);break;default:throw new Error(`Unknown action type: ${e.type}`)}a.status="completed"}catch(r){a.status="failed",a.error=r.message}return a}async calculateLeadScore(e,t=null){var s;const a=Array.from(this.scoringRules.values()).filter(e=>e.isActive);let r=0;const i=[],l=t||{skills:["React","JavaScript","Node.js"],experience:5,location:"San Francisco",education:"Bachelor",availability:"immediate"};for(const o of a){let e=0,t="";switch(o.category){case"skills":const a=(null==(s=l.skills)?void 0:s.filter(e=>o.condition.toLowerCase().includes(e.toLowerCase())).length)||0;e=a>0?o.points:0,t=`${a} matching skills found`;break;case"experience":const r=l.experience||0;o.condition.includes(">=")&&r>=parseInt(o.condition.split(">=")[1])&&(e=o.points,t=`${r} years experience meets requirement`);break;case"location":l.location&&o.condition.includes(l.location)&&(e=o.points,t=`Located in preferred area: ${l.location}`);break;case"availability":"immediate"===l.availability&&o.condition.includes("immediate")&&(e=o.points,t="Available immediately");break;default:e=Math.random()>.5?o.points:0,t="Custom rule evaluation"}e>0&&(i.push({category:o.category,score:e,maxScore:o.points,reasoning:t,weight:o.weight}),r+=e*o.weight)}const n=await this.generateAIPredictions(l),c={candidateId:e,totalScore:Math.min(r,100),breakdown:i,lastCalculated:new Date,trend:this.calculateTrend(e,r),aiPredictions:n};return this.leadScores.set(e,c),c}async generateAIPredictions(e){return[{type:"placement-success",probability:Math.floor(40*Math.random())+60,confidence:Math.floor(30*Math.random())+70,factors:["Strong technical skills","Good cultural fit","Market demand"],reasoning:"High probability based on skill match and market conditions"},{type:"time-to-hire",probability:Math.floor(20*Math.random())+15,confidence:Math.floor(20*Math.random())+80,factors:["Experience level","Interview availability","Decision speed"],reasoning:"Estimated based on similar candidate profiles"}]}calculateTrend(e,t){var s;const a=(null==(s=this.leadScores.get(e))?void 0:s.totalScore)||0;return t>a?"increasing":t<a?"decreasing":"stable"}async createTerritory(e){const t={id:`territory_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...e,performance:{totalCandidates:0,placedCandidates:0,averageTimeToHire:0,conversionRate:0,revenue:0,lastUpdated:new Date},createdAt:new Date};return this.territories.set(t.id,t),t}async assignTerritory(e,t=null){const s=Array.from(this.territories.values()).filter(e=>e.isActive),a=t||{location:"San Francisco",skills:["React"]};for(const r of s)if(await this.matchesTerritoryCriteria(a,r.criteria)){const t=r.assignedRecruiters[0];return await this.assignRecruiter(e,t),r.id}return null}async matchesTerritoryCriteria(e,t){return!(t.locations&&!t.locations.includes(e.location))&&!(t.skills&&!t.skills.some(t=>{var s;return null==(s=e.skills)?void 0:s.includes(t)}))}async createScoringRule(e){const t={id:`rule_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...e,createdAt:new Date};return this.scoringRules.set(t.id,t),t}async updateScoringRule(e,t){const s=this.scoringRules.get(e);if(!s)throw new Error("Scoring rule not found");const a={...s,...t};return this.scoringRules.set(e,a),a}async getAllScoringRules(){return Array.from(this.scoringRules.values())}async getWorkflowAnalytics(e){const t=Array.from(this.executions.values()).filter(t=>t.workflowId===e),s=t.length,a=t.filter(e=>"completed"===e.status).length,r=t.filter(e=>"failed"===e.status).length;return{workflowId:e,totalExecutions:s,successfulExecutions:a,failedExecutions:r,averageExecutionTime:this.calculateAverageExecutionTime(t),executionsByDay:this.getExecutionsByDay(t),actionPerformance:this.getActionPerformance(t),lastUpdated:new Date}}calculateAverageExecutionTime(e){const t=e.filter(e=>e.completedAt);if(0===t.length)return 0;return t.reduce((e,t)=>e+(t.completedAt.getTime()-t.startedAt.getTime()),0)/t.length}getExecutionsByDay(e){const t={};return e.forEach(e=>{const s=e.startedAt.toISOString().split("T")[0];t[s]=(t[s]||0)+1}),Object.entries(t).map(([e,t])=>({date:e,count:t}))}getActionPerformance(e){const t={};return e.forEach(e=>{e.executedActions.forEach(e=>{t[e.actionType]||(t[e.actionType]={actionType:e.actionType,totalExecutions:0,successfulExecutions:0,totalTime:0});const s=t[e.actionType];s.totalExecutions++,"completed"===e.status&&s.successfulExecutions++,e.duration&&(s.totalTime+=e.duration)})}),Object.values(t).map(e=>({actionType:e.actionType,totalExecutions:e.totalExecutions,successRate:e.successfulExecutions/e.totalExecutions*100,averageExecutionTime:e.totalTime/e.totalExecutions,errorRate:(e.totalExecutions-e.successfulExecutions)/e.totalExecutions*100}))}async sendEmail(e,t){return{sent:!0,messageId:`msg_${Date.now()}`}}async updateCandidateStatus(e,t){return{updated:!0}}async assignRecruiter(e,t){return{assigned:!0}}async createTask(e,t){return{id:`task_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...e,relatedTo:{type:"candidate",id:t},createdAt:new Date}}async callWebhook(e,t,s){return{called:!0,response:"success"}}initializeMockData(){[{id:"workflow_1",name:"New Candidate Onboarding",description:"Automated workflow for new candidate registration",isActive:!0,trigger:{id:"trigger_1",type:"candidate-added",conditions:{},description:"When a new candidate is added"},conditions:[{id:"condition_1",type:"score-greater-than",field:"leadScore",operator:"greater-than",value:70,logicalOperator:"AND"}],actions:[{id:"action_1",type:"send-email",parameters:{template:"welcome-email",subject:"Welcome to our talent network!"},delay:0,description:"Send welcome email"},{id:"action_2",type:"calculate-score",parameters:{},delay:5,description:"Calculate lead score"},{id:"action_3",type:"assign-territory",parameters:{},delay:10,description:"Auto-assign to territory"}],createdBy:"admin",createdAt:new Date("2024-01-01"),lastModified:new Date("2024-01-15"),executionCount:45,successRate:92.5},{id:"workflow_2",name:"High-Value Candidate Alert",description:"Alert recruiters when high-scoring candidates are added",isActive:!0,trigger:{id:"trigger_2",type:"score-threshold",conditions:{threshold:85},description:"When candidate score exceeds 85"},conditions:[],actions:[{id:"action_4",type:"create-task",parameters:{title:"Review high-value candidate",priority:"high",assignedTo:"auto"},delay:0,description:"Create review task"},{id:"action_5",type:"send-email",parameters:{template:"recruiter-alert",subject:"High-value candidate alert"},delay:0,description:"Alert recruiter"}],createdBy:"admin",createdAt:new Date("2024-01-10"),lastModified:new Date("2024-01-20"),executionCount:23,successRate:95.7}].forEach(e=>{this.workflows.set(e.id,e)});[{id:"rule_1",name:"React Experience",category:"skills",condition:'skills.includes("React")',points:25,weight:1.2,isActive:!0,description:"Bonus points for React experience",createdBy:"admin",createdAt:new Date("2024-01-01")},{id:"rule_2",name:"Senior Experience",category:"experience",condition:"experience >= 5",points:30,weight:1.5,isActive:!0,description:"Bonus for 5+ years experience",createdBy:"admin",createdAt:new Date("2024-01-01")},{id:"rule_3",name:"Immediate Availability",category:"availability",condition:'availability === "immediate"',points:20,weight:1,isActive:!0,description:"Bonus for immediate availability",createdBy:"admin",createdAt:new Date("2024-01-01")}].forEach(e=>{this.scoringRules.set(e.id,e)});[{id:"territory_1",name:"West Coast Tech",type:"geographic",criteria:{locations:["San Francisco","Los Angeles","Seattle"],skills:["React","Node.js","Python"]},assignedRecruiters:["recruiter_1","recruiter_2"],isActive:!0,performance:{totalCandidates:156,placedCandidates:42,averageTimeToHire:18,conversionRate:26.9,revenue:42e4,lastUpdated:new Date},createdBy:"admin",createdAt:new Date("2024-01-01")},{id:"territory_2",name:"Enterprise Sales",type:"skill-based",criteria:{skills:["Sales","Account Management","CRM"],experienceLevels:["senior","lead"]},assignedRecruiters:["recruiter_3"],isActive:!0,performance:{totalCandidates:89,placedCandidates:28,averageTimeToHire:22,conversionRate:31.5,revenue:28e4,lastUpdated:new Date},createdBy:"admin",createdAt:new Date("2024-01-01")}].forEach(e=>{this.territories.set(e.id,e)})}},G=({breakdown:t,totalScore:s})=>{const a=t.reduce((e,t)=>e+t.maxScore*t.weight,0);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Score Breakdown"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s}),e.jsxs("div",{className:"text-sm text-gray-500",children:["/ ",Math.round(a)]})]})]}),e.jsx("div",{className:"space-y-4",children:t.map((t,s)=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:t.category.replace("-"," ")}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.score," / ",t.maxScore," (×",t.weight,")"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:t.score/t.maxScore*100+"%"}})}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.reasoning})]})},s))})]})},J=({predictions:t})=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(N,{className:"w-5 h-5 text-purple-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Predictions"})]}),e.jsx("div",{className:"space-y-4",children:t.map((t,s)=>{const a=(e=>{switch(e){case"placement-success":return u;case"time-to-hire":return v;case"salary-negotiation":return S;default:return N}})(t.type);return e.jsxs("div",{className:"p-4 rounded-lg border "+(r=t.probability,r>=80?"text-green-600 bg-green-50 border-green-200":r>=60?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(a,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"font-medium capitalize",children:t.type.replace("-"," ")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold",children:"time-to-hire"===t.type?`${t.probability} days`:`${t.probability}%`}),e.jsxs("div",{className:"text-xs opacity-75",children:[t.confidence,"% confidence"]})]})]}),e.jsx("div",{className:"text-sm opacity-90 mb-2",children:t.reasoning}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.factors.map((t,s)=>e.jsx("span",{className:"px-2 py-1 bg-white bg-opacity-50 rounded text-xs",children:t},s))})]},s);var r})})]}),K=({rules:r,onRuleUpdate:i,onRuleCreate:l,onRuleDelete:n})=>{const[c,o]=s.useState(!1),[d,x]=s.useState(null),[m,u]=s.useState({name:"",category:"skills",condition:"",points:10,weight:1,description:"",isActive:!0});return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Scoring Rules"}),e.jsx(t,{onClick:()=>{x(null),u({name:"",category:"skills",condition:"",points:10,weight:1,description:"",isActive:!0}),o(!0)},icon:e.jsx(w,{className:"w-4 h-4"}),size:"sm",children:"Add Rule"})]}),e.jsx("div",{className:"space-y-3",children:r.map(t=>e.jsxs("div",{className:"p-4 rounded-lg border "+(t.isActive?"border-gray-200 bg-white":"border-gray-100 bg-gray-50"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium "+(t.isActive?"text-gray-900":"text-gray-500"),children:t.name}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:t.category}),!t.isActive&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:"Inactive"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm font-medium text-green-600",children:["+",t.points," pts (×",t.weight,")"]}),e.jsx("button",{onClick:()=>(e=>{x(e),u({name:e.name,category:e.category,condition:e.condition,points:e.points,weight:e.weight,description:e.description,isActive:e.isActive}),o(!0)})(t),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(k,{className:"w-4 h-4 text-gray-500"})}),e.jsx("button",{onClick:()=>n(t.id),className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(y,{className:"w-4 h-4 text-red-500"})})]})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:t.description}),e.jsx("div",{className:"text-xs text-gray-500 font-mono bg-gray-50 p-2 rounded",children:t.condition})]},t.id))}),e.jsx(a,{isOpen:c,onClose:()=>o(!1),title:d?"Edit Scoring Rule":"Create Scoring Rule",className:"max-w-lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rule Name *"}),e.jsx("input",{type:"text",value:m.name,onChange:e=>u(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., React Experience Bonus"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),e.jsx("select",{value:m.category,onChange:e=>u(t=>({...t,category:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:"skills",label:"Skills"},{value:"experience",label:"Experience"},{value:"education",label:"Education"},{value:"location",label:"Location"},{value:"availability",label:"Availability"},{value:"market-demand",label:"Market Demand"},{value:"referral",label:"Referral"},{value:"custom",label:"Custom"}].map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Condition *"}),e.jsx("input",{type:"text",value:m.condition,onChange:e=>u(t=>({...t,condition:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., skills.includes('React')"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Use JavaScript-like expressions to define the condition"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Points *"}),e.jsx("input",{type:"number",value:m.points,onChange:e=>u(t=>({...t,points:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"1",max:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight"}),e.jsx("input",{type:"number",step:"0.1",value:m.weight,onChange:e=>u(t=>({...t,weight:parseFloat(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0.1",max:"3.0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:m.description,onChange:e=>u(t=>({...t,description:e.target.value})),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Describe what this rule does"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:m.isActive,onChange:e=>u(t=>({...t,isActive:e.target.checked})),className:"mr-2"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm text-gray-700",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(t,{variant:"outline",onClick:()=>o(!1),className:"flex-1",children:"Cancel"}),e.jsx(t,{onClick:async()=>{try{d?await i(d.id,m):await l(m),o(!1)}catch(e){}},className:"flex-1",disabled:!m.name||!m.condition,children:d?"Update Rule":"Create Rule"})]})]})})]})},Q=({candidate:a,onScoreUpdate:r,showBreakdown:i=!0})=>{const[l,n]=s.useState(null),[o,d]=s.useState([]),[x,m]=s.useState(!1),[h,g]=s.useState(!1);s.useEffect(()=>{y(),a&&N()},[a]);const y=async()=>{try{const e=await q.getAllScoringRules();d(e)}catch(e){}},N=async()=>{if(a){m(!0);try{const e=await q.calculateLeadScore(a.id,a);n(e),r&&r(a.id,e)}catch(e){}finally{m(!1)}}};return a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(u,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Lead Score"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{onClick:N,disabled:x,size:"sm",icon:e.jsx(c,{className:"w-4 h-4"}),children:x?"Calculating...":"Recalculate"}),e.jsx(t,{onClick:()=>g(!h),variant:"outline",size:"sm",icon:e.jsx(p,{className:"w-4 h-4"}),children:"Rules"})]})]}),l?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"text-3xl font-bold "+(w=l.totalScore,w>=80?"text-green-600":w>=60?"text-yellow-600":"text-red-600"),children:Math.round(l.totalScore)}),e.jsx("span",{className:"text-gray-500",children:"/100"}),(t=>{switch(t){case"increasing":return e.jsx(v,{className:"w-4 h-4 text-green-600"});case"decreasing":return e.jsx(f,{className:"w-4 h-4 text-red-600"});default:return e.jsx(j,{className:"w-4 h-4 text-gray-600"})}})(l.trend)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(l.totalScore>=80?"bg-green-100 text-green-800":l.totalScore>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:(e=>e>=80?"Hot Lead":e>=60?"Warm Lead":"Cold Lead")(l.totalScore)}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Last calculated: ",new Date(l.lastCalculated).toLocaleString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:[l.breakdown.length," factors"]}),l.previousScore&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Previous: ",Math.round(l.previousScore)]})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(b,{className:"w-8 h-8 mx-auto mb-2"}),e.jsx("p",{children:'Click "Calculate" to generate lead score'})]})]}),i&&l&&e.jsx(G,{breakdown:l.breakdown,totalScore:Math.round(l.totalScore)}),l&&l.aiPredictions&&e.jsx(J,{predictions:l.aiPredictions}),h&&e.jsx(K,{rules:o,onRuleCreate:async e=>{try{await q.createScoringRule(e),await y(),await N()}catch(t){}},onRuleUpdate:async(e,t)=>{try{await q.updateScoringRule(e,t),await y(),await N()}catch(s){}},onRuleDelete:async e=>{try{await q.deleteScoringRule(e),await y(),await N()}catch(t){}}})]}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(u,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Select a candidate to view lead scoring"})]})});var w},V=({territory:t})=>{const{performance:s}=t,a=s.totalCandidates>0?s.placedCandidates/s.totalCandidates*100:0;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg "+(r=a,r>=30?"text-green-600 bg-green-50":r>=20?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"),children:e.jsx(C,{className:"w-5 h-5"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:t.type.replace("-"," ")})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[t.isActive?e.jsx(A,{className:"w-4 h-4 text-green-500"}):e.jsx(D,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:t.isActive?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.totalCandidates}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Candidates"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.placedCandidates}),e.jsx("div",{className:"text-sm text-gray-500",children:"Placed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(a),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Conversion Rate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[s.averageTimeToHire,"d"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Avg. Time to Hire"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"w-4 h-4 text-green-600 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Revenue"})]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["$",s.revenue.toLocaleString()]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Assigned Recruiters"}),e.jsx("span",{className:"text-xs text-gray-500",children:t.assignedRecruiters.length})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.assignedRecruiters.map((t,s)=>e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:["Recruiter ",s+1]},t))})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Criteria"}),e.jsxs("div",{className:"space-y-1",children:[t.criteria.locations&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(R,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{children:["Locations: ",t.criteria.locations.join(", ")]})]}),t.criteria.skills&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(u,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{children:["Skills: ",t.criteria.skills.join(", ")]})]}),t.criteria.experienceLevels&&e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{children:["Experience: ",t.criteria.experienceLevels.join(", ")]})]})]})]})]});var r},X=({territory:r,isOpen:i,onClose:l,onSave:n})=>{const[c,o]=s.useState({name:"",type:"geographic",criteria:{locations:[],skills:[],industries:[],experienceLevels:[],salaryRanges:[]},assignedRecruiters:[],isActive:!0}),[d,x]=s.useState(""),[m,u]=s.useState(""),[h,g]=s.useState("");s.useEffect(()=>{o(r?{name:r.name,type:r.type,criteria:r.criteria,assignedRecruiters:r.assignedRecruiters,isActive:r.isActive}:{name:"",type:"geographic",criteria:{locations:[],skills:[],industries:[],experienceLevels:[],salaryRanges:[]},assignedRecruiters:[],isActive:!0})},[r,i]);const p=(e,t,s)=>{t.trim()&&!c.criteria[e].includes(t.trim())&&(o(s=>({...s,criteria:{...s.criteria,[e]:[...s.criteria[e],t.trim()]}})),s(""))},y=(e,t)=>{o(s=>({...s,criteria:{...s.criteria,[e]:s.criteria[e].filter((e,s)=>s!==t)}}))};return e.jsx(a,{isOpen:i,onClose:l,title:r?"Edit Territory":"Create Territory",className:"max-w-2xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Territory Name *"}),e.jsx("input",{type:"text",value:c.name,onChange:e=>o(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., West Coast Tech"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Territory Type *"}),e.jsx("select",{value:c.type,onChange:e=>o(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:"geographic",label:"Geographic"},{value:"skill-based",label:"Skill Based"},{value:"industry",label:"Industry"},{value:"experience-level",label:"Experience Level"},{value:"custom",label:"Custom"}].map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Locations"}),e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx("input",{type:"text",value:d,onChange:e=>x(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),p("locations",d,x))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add location (e.g., San Francisco)"}),e.jsx(t,{onClick:()=>p("locations",d,x),size:"sm",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.criteria.locations.map((t,s)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:[t,e.jsx("button",{onClick:()=>y("locations",s),className:"ml-1 text-blue-600 hover:text-blue-800",children:"×"})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Skills"}),e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx("input",{type:"text",value:m,onChange:e=>u(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),p("skills",m,u))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add skill (e.g., React)"}),e.jsx(t,{onClick:()=>p("skills",m,u),size:"sm",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.criteria.skills.map((t,s)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 text-sm rounded-full",children:[t,e.jsx("button",{onClick:()=>y("skills",s),className:"ml-1 text-green-600 hover:text-green-800",children:"×"})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Industries"}),e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx("input",{type:"text",value:h,onChange:e=>g(e.target.value),onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),p("industries",h,g))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Add industry (e.g., SaaS)"}),e.jsx(t,{onClick:()=>p("industries",h,g),size:"sm",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:c.criteria.industries.map((t,s)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-sm rounded-full",children:[t,e.jsx("button",{onClick:()=>y("industries",s),className:"ml-1 text-purple-600 hover:text-purple-800",children:"×"})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Experience Levels"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["junior","mid","senior","lead","executive"].map(t=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:c.criteria.experienceLevels.includes(t),onChange:e=>{e.target.checked?o(e=>({...e,criteria:{...e.criteria,experienceLevels:[...e.criteria.experienceLevels,t]}})):o(e=>({...e,criteria:{...e.criteria,experienceLevels:e.criteria.experienceLevels.filter(e=>e!==t)}}))},className:"mr-2"}),e.jsx("span",{className:"text-sm capitalize",children:t})]},t))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:c.isActive,onChange:e=>o(t=>({...t,isActive:e.target.checked})),className:"mr-2"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm text-gray-700",children:"Active Territory"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(t,{variant:"outline",onClick:l,className:"flex-1",children:"Cancel"}),e.jsx(t,{onClick:()=>{n(c),l()},className:"flex-1",disabled:!c.name,children:r?"Update Territory":"Create Territory"})]})]})})},Y=({territories:a,onRuleCreate:r,onRuleUpdate:i,onRuleDelete:l})=>{const[n,c]=s.useState([{id:"rule_1",name:"West Coast Tech Assignment",priority:1,conditions:[{field:"location",operator:"contains",value:"San Francisco"},{field:"skills",operator:"contains",value:"React"}],territoryId:"territory_1",isActive:!0,description:"Assign SF-based React developers to West Coast Tech territory"}]);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Assignment Rules"}),e.jsx(t,{icon:e.jsx(w,{className:"w-4 h-4"}),size:"sm",children:"Add Rule"})]}),e.jsx("div",{className:"space-y-4",children:n.map(t=>{var s;return e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t.name}),e.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:["Priority ",t.priority]}),!t.isActive&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:"Inactive"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(k,{className:"w-4 h-4 text-gray-500"})}),e.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:e.jsx(y,{className:"w-4 h-4 text-red-500"})})]})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:t.description}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Conditions: ",t.conditions.length," | Territory: ",(null==(s=a.find(e=>e.id===t.territoryId))?void 0:s.name)||"Unknown"]})]},t.id)})})]})},Z=()=>{const[a,r]=s.useState([]),[i,l]=s.useState(!0),[n,c]=s.useState(!1),[o,d]=s.useState(null),[x,m]=s.useState("territories");s.useEffect(()=>{u()},[]);const u=async()=>{try{r([{id:"territory_1",name:"West Coast Tech",type:"geographic",criteria:{locations:["San Francisco","Los Angeles","Seattle"],skills:["React","Node.js","Python"]},assignedRecruiters:["recruiter_1","recruiter_2"],isActive:!0,performance:{totalCandidates:156,placedCandidates:42,averageTimeToHire:18,conversionRate:26.9,revenue:42e4,lastUpdated:new Date},createdBy:"admin",createdAt:new Date("2024-01-01")},{id:"territory_2",name:"Enterprise Sales",type:"skill-based",criteria:{skills:["Sales","Account Management","CRM"],experienceLevels:["senior","lead"]},assignedRecruiters:["recruiter_3"],isActive:!0,performance:{totalCandidates:89,placedCandidates:28,averageTimeToHire:22,conversionRate:31.5,revenue:28e4,lastUpdated:new Date},createdBy:"admin",createdAt:new Date("2024-01-01")}])}catch(e){}finally{l(!1)}},h=[{id:"territories",label:"Territories",icon:C},{id:"rules",label:"Assignment Rules",icon:p},{id:"analytics",label:"Analytics",icon:S}];return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading territories..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Territory Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage territories and automatic candidate assignment"})]}),e.jsx(t,{onClick:()=>{d(null),c(!0)},icon:e.jsx(w,{className:"w-4 h-4"}),children:"Create Territory"})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:h.map(t=>{const s=t.icon;return e.jsxs("button",{onClick:()=>m(t.id),className:"flex items-center py-2 px-1 border-b-2 font-medium text-sm "+(x===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.jsx(s,{className:"w-4 h-4 mr-2"}),t.label]},t.id)})})}),"territories"===x&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(t=>e.jsxs("div",{className:"relative",children:[e.jsx(V,{territory:t}),e.jsxs("div",{className:"absolute top-4 right-4 flex space-x-1",children:[e.jsx("button",{onClick:()=>(e=>{d(e),c(!0)})(t),className:"p-1 bg-white rounded shadow hover:bg-gray-50",children:e.jsx(k,{className:"w-4 h-4 text-gray-500"})}),e.jsx("button",{onClick:()=>(async e=>{try{r(t=>t.filter(t=>t.id!==e))}catch(t){}})(t.id),className:"p-1 bg-white rounded shadow hover:bg-gray-50",children:e.jsx(y,{className:"w-4 h-4 text-red-500"})})]})]},t.id))}),"rules"===x&&e.jsx(Y,{territories:a,onRuleCreate:()=>{},onRuleUpdate:()=>{},onRuleDelete:()=>{}}),"analytics"===x&&e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Territory Analytics"}),e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Territory analytics coming soon"})]})]}),e.jsx(X,{territory:o,isOpen:n,onClose:()=>c(!1),onSave:async e=>{try{if(o)r(t=>t.map(t=>t.id===o.id?{...t,...e}:t));else{const t={id:`territory_${Date.now()}`,...e,performance:{totalCandidates:0,placedCandidates:0,averageTimeToHire:0,conversionRate:0,revenue:0,lastUpdated:new Date},createdBy:"current-user",createdAt:new Date};r(e=>[...e,t])}}catch(t){}}})]})},ee=({status:t})=>{const s=(e=>{switch(e){case"completed":return{icon:A,color:"text-green-600 bg-green-50 border-green-200"};case"failed":return{icon:B,color:"text-red-600 bg-red-50 border-red-200"};case"running":return{icon:_,color:"text-blue-600 bg-blue-50 border-blue-200"};case"pending":return{icon:m,color:"text-yellow-600 bg-yellow-50 border-yellow-200"};default:return{icon:D,color:"text-gray-600 bg-gray-50 border-gray-200"}}})(t),a=s.icon;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ${s.color}`,children:[e.jsx(a,{className:"w-3 h-3 mr-1"}),t.charAt(0).toUpperCase()+t.slice(1)]})},te=({workflow:t,analytics:s})=>{const a=s?s.successfulExecutions/s.totalExecutions*100:0;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500",children:t.description})]}),e.jsx("div",{className:"flex items-center space-x-2",children:t.isActive?e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium text-green-800 bg-green-100",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),"Active"]}):e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium text-gray-600 bg-gray-100",children:[e.jsx(W,{className:"w-3 h-3 mr-1"}),"Inactive"]})})]}),s&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:s.totalExecutions}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total Executions"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold "+(r=a,r>=90?"text-green-600":r>=70?"text-yellow-600":"text-red-600"),children:[Math.round(a),"%"]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Success Rate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.successfulExecutions}),e.jsx("div",{className:"text-sm text-gray-500",children:"Successful"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.failedExecutions}),e.jsx("div",{className:"text-sm text-gray-500",children:"Failed"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Avg. Execution Time"}),e.jsxs("span",{children:[s?Math.round(s.averageExecutionTime/1e3):0,"s"]})]}),t.lastExecuted&&e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mt-1",children:[e.jsx("span",{children:"Last Executed"}),e.jsx("span",{children:new Date(t.lastExecuted).toLocaleString()})]})]});var r},se=({executions:a,onRefresh:r})=>{const[l,n]=s.useState(a),[c,o]=s.useState("all"),[d,m]=s.useState("all");s.useEffect(()=>{let e=a;if("all"!==c&&(e=e.filter(e=>e.status===c)),"all"!==d){const t=new Date,s=new Date;switch(d){case"today":s.setHours(0,0,0,0);break;case"week":s.setDate(t.getDate()-7);break;case"month":s.setMonth(t.getMonth()-1)}e=e.filter(e=>new Date(e.startedAt)>=s)}n(e)},[a,c,d]);const u=(e,t)=>{if(!t)return"Running...";const s=new Date(t)-new Date(e);return`${Math.round(s/1e3)}s`};return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Execution History"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{onClick:r,variant:"outline",size:"sm",icon:e.jsx(M,{className:"w-4 h-4"}),children:"Refresh"}),e.jsx(t,{variant:"outline",size:"sm",icon:e.jsx(i,{className:"w-4 h-4"}),children:"Export"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(x,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:c,onChange:e=>o(e.target.value),className:"px-3 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"pending",children:"Pending"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"w-4 h-4 text-gray-500"}),e.jsxs("select",{value:d,onChange:e=>m(e.target.value),className:"px-3 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last Week"}),e.jsx("option",{value:"month",children:"Last Month"})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[l.length," of ",a.length," executions"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Execution ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Workflow"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Started"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-900",children:t.id.slice(-8)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["Workflow ",t.workflowId.slice(-4)]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(ee,{status:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.startedAt).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u(t.startedAt,t.completedAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs",children:[t.executedActions.length," actions"]}),t.error&&e.jsx("span",{className:"text-xs text-red-600",title:t.error,children:"Error"})]})})]},t.id))})]})}),0===l.length&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(L,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No executions found"})]})]})},ae=({actionPerformance:t})=>t&&0!==t.length?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Action Performance"}),e.jsx("div",{className:"space-y-4",children:t.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(c,{className:"w-5 h-5 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 capitalize",children:t.actionType.replace("-"," ")}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.totalExecutions," executions"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold "+(t.successRate>=90?"text-green-600":t.successRate>=70?"text-yellow-600":"text-red-600"),children:[Math.round(t.successRate),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Success"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[Math.round(t.averageExecutionTime),"ms"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Avg Time"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold text-red-600",children:[Math.round(t.errorRate),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Error Rate"})]})]})})]},s))})]}):e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Action Performance"}),e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No action performance data available"})]})]}),re=({executionsByDay:t})=>{if(!t||0===t.length)return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Execution Timeline"}),e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(v,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No timeline data available"})]})]});const s=Math.max(...t.map(e=>e.count));return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Execution Timeline"}),e.jsx("div",{className:"space-y-2",children:t.slice(-14).map((t,a)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-20 text-sm text-gray-600",children:new Date(t.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx("div",{className:"flex-1 mx-4",children:e.jsx("div",{className:"bg-gray-200 rounded-full h-4 relative",children:e.jsx("div",{className:"bg-blue-600 h-4 rounded-full transition-all duration-300",style:{width:t.count/s*100+"%"}})})}),e.jsx("div",{className:"w-12 text-sm text-gray-900 text-right",children:t.count})]},a))})]})},ie=()=>{const[a,r]=s.useState([]),[i,l]=s.useState([]),[n,c]=s.useState({}),[o,d]=s.useState(!0),[x,m]=s.useState("all");s.useEffect(()=>{u()},[]);const u=async()=>{try{d(!0);const e=await q.getAllWorkflows();r(e);const t=[{id:"exec_1",workflowId:"workflow_1",status:"completed",startedAt:new Date(Date.now()-36e5),completedAt:new Date(Date.now()-35e5),executedActions:[{actionId:"action_1",actionType:"send-email",status:"completed"},{actionId:"action_2",actionType:"calculate-score",status:"completed"}]},{id:"exec_2",workflowId:"workflow_1",status:"failed",startedAt:new Date(Date.now()-72e5),completedAt:new Date(Date.now()-71e5),executedActions:[{actionId:"action_1",actionType:"send-email",status:"failed"}],error:"Email service unavailable"},{id:"exec_3",workflowId:"workflow_2",status:"completed",startedAt:new Date(Date.now()-18e5),completedAt:new Date(Date.now()-17e5),executedActions:[{actionId:"action_4",actionType:"create-task",status:"completed"},{actionId:"action_5",actionType:"send-email",status:"completed"}]}];l(t);const s={};for(const a of e){const e=await q.getWorkflowAnalytics(a.id);s[a.id]=e}c(s)}catch(e){}finally{d(!1)}},h="all"===x?i:i.filter(e=>e.workflowId===x),g="all"===x?null:n[x];return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading analytics..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Workflow Analytics"}),e.jsx("p",{className:"text-gray-600",children:"Monitor workflow performance and execution history"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:x,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Workflows"}),a.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(t,{onClick:u,variant:"outline",icon:e.jsx(M,{className:"w-4 h-4"}),children:"Refresh"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(t=>e.jsx(te,{workflow:t,analytics:n[t.id]},t.id))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(re,{executionsByDay:(null==g?void 0:g.executionsByDay)||[]}),e.jsx(ae,{actionPerformance:(null==g?void 0:g.actionPerformance)||[]})]}),e.jsx(se,{executions:h,onRefresh:u})]})},le=({workflow:t,onEdit:s,onToggle:a,onDelete:r})=>{var i,l,n;const o=e=>e?"text-green-600 bg-green-50":"text-gray-600 bg-gray-50";return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-2 rounded-lg ${o(t.isActive)}`,children:e.jsx(c,{className:"w-5 h-5"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500",children:t.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>a(t.id,!t.isActive),className:`p-2 rounded-lg ${o(t.isActive)}`,children:t.isActive?e.jsx(W,{className:"w-4 h-4"}):e.jsx(_,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>s(t),className:"p-2 rounded-lg text-gray-600 bg-gray-50 hover:bg-gray-100",children:e.jsx(p,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:t.executionCount}),e.jsx("div",{className:"text-xs text-gray-500",children:"Executions"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[Math.round(t.successRate),"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Success Rate"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-blue-600",children:(null==(i=t.actions)?void 0:i.length)||0}),e.jsx("div",{className:"text-xs text-gray-500",children:"Actions"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Trigger: ",(null==(n=null==(l=t.trigger)?void 0:l.type)?void 0:n.replace("-"," "))||"Not set"]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(t.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:t.isActive?"Active":"Inactive"})]}),t.lastExecuted&&e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Last executed: ",new Date(t.lastExecuted).toLocaleString()]})]})},ne=({workflows:t,territories:s,leadScores:a})=>{const r=t.filter(e=>e.isActive).length,i=t.reduce((e,t)=>e+t.executionCount,0),l=t.length>0?t.reduce((e,t)=>e+t.successRate,0)/t.length:0,n=[{label:"Active Workflows",value:r,total:t.length,icon:c,color:"text-blue-600 bg-blue-50"},{label:"Total Executions",value:i,icon:L,color:"text-green-600 bg-green-50"},{label:"Success Rate",value:`${Math.round(l)}%`,icon:u,color:"text-purple-600 bg-purple-50"},{label:"Territories",value:s.filter(e=>e.isActive).length,total:s.length,icon:C,color:"text-orange-600 bg-orange-50"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:n.map((t,s)=>{const a=t.icon;return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-lg ${t.color}`,children:e.jsx(a,{className:"w-6 h-6"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[t.value,t.total&&e.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["/",t.total]})]}),e.jsx("div",{className:"text-sm text-gray-600",children:t.label})]})]})},s)})})},ce=()=>{const[r,i]=s.useState("overview"),[l,n]=s.useState([]),[o,d]=s.useState([]),[x,m]=s.useState([]),[h,g]=s.useState(!0),[p,y]=s.useState(!1),[b,j]=s.useState(null),[f,v]=s.useState(null);s.useEffect(()=>{k()},[]);const k=async()=>{try{g(!0);const e=await q.getAllWorkflows();n(e);d([{id:"territory_1",name:"West Coast Tech",type:"geographic",isActive:!0},{id:"territory_2",name:"Enterprise Sales",type:"skill-based",isActive:!0}]);m([{candidateId:"candidate_1",totalScore:85,trend:"increasing"},{candidateId:"candidate_2",totalScore:72,trend:"stable"},{candidateId:"candidate_3",totalScore:91,trend:"increasing"}])}catch(e){}finally{g(!1)}},A=()=>{j(null),y(!0)},D=e=>{j(e),y(!0)},T=async(e,t)=>{try{await q.updateWorkflow(e,{isActive:t}),await k()}catch(s){}},R=async e=>{try{await q.deleteWorkflow(e),await k()}catch(t){}},E=[{id:"overview",label:"Overview",icon:L},{id:"workflows",label:"Workflows",icon:c},{id:"scoring",label:"Lead Scoring",icon:u},{id:"territories",label:"Territories",icon:C},{id:"analytics",label:"Analytics",icon:S}];return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-500",children:"Loading workflow automation..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Workflow Automation"}),e.jsx("p",{className:"text-gray-600",children:"Automate recruitment processes and optimize candidate management"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(t,{onClick:A,icon:e.jsx(w,{className:"w-4 h-4"}),children:"Create Workflow"})})]}),e.jsx(ne,{workflows:l,territories:o,leadScores:x}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:E.map(t=>{const s=t.icon;return e.jsxs("button",{onClick:()=>i(t.id),className:"flex items-center py-2 px-1 border-b-2 font-medium text-sm "+(r===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.jsx(s,{className:"w-4 h-4 mr-2"}),t.label]},t.id)})})}),"overview"===r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Workflows"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.slice(0,6).map(t=>e.jsx(le,{workflow:t,onEdit:D,onToggle:T,onDelete:R},t.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(t,{onClick:A,variant:"outline",className:"justify-start",icon:e.jsx(c,{className:"w-4 h-4"}),children:"Create New Workflow"}),e.jsx(t,{onClick:()=>i("scoring"),variant:"outline",className:"justify-start",icon:e.jsx(N,{className:"w-4 h-4"}),children:"Configure Lead Scoring"}),e.jsx(t,{onClick:()=>i("territories"),variant:"outline",className:"justify-start",icon:e.jsx($,{className:"w-4 h-4"}),children:"Manage Territories"})]})]})]}),"workflows"===r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"All Workflows"}),e.jsx(t,{onClick:A,icon:e.jsx(w,{className:"w-4 h-4"}),children:"Create Workflow"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(t=>e.jsx(le,{workflow:t,onEdit:D,onToggle:T,onDelete:R},t.id))})]}),"scoring"===r&&e.jsx(Q,{candidate:f,onScoreUpdate:(e,t)=>{},showBreakdown:!0}),"territories"===r&&e.jsx(Z,{}),"analytics"===r&&e.jsx(ie,{}),p&&e.jsx(a,{isOpen:p,onClose:()=>y(!1),title:"",className:"max-w-full max-h-full m-0 p-0",showCloseButton:!1,children:e.jsx(H,{workflow:b,onSave:async e=>{try{b?await q.updateWorkflow(b.id,e):await q.createWorkflow(e),await k(),y(!1)}catch(t){}},onClose:()=>y(!1)})})]})};export{ce as default};
